---
title: Better Auth –≤ Next.js - Client integration –∏ –ø–æ–ª–Ω—ã–π data-flow
name: bauth-client
canvasWidth: 800
routerMode: hash
---
<style>
.lab-badge {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 999px;
    background: #eef2ff;
    color: #3730a3;
    font-weight: 600;
    font-size: 0.9em;
}
.mermaid-fit {
  transform: scale(0.7);
  transform-origin: top center;
}
</style>

# Better Auth –≤ Next.js

### –õ–µ–∫—Ü–∏—è 4  
Client integration –∏ –ø–æ–ª–Ω—ã–π –∑–∞—â–∏—â—ë–Ω–Ω—ã–π data-flow

---

# –¶–µ–ª—å –ª–µ–∫—Ü–∏–∏

–°–æ–±—Ä–∞—Ç—å –≤—Å–µ —É—Ä–æ–≤–Ω–∏ –∑–∞—â–∏—Ç—ã  
–≤ –µ–¥–∏–Ω—É—é production-ready –º–æ–¥–µ–ª—å  
–∑–∞—â–∏—â—ë–Ω–Ω–æ–≥–æ fullstack-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫ —ç—Ç–æ–º—É –º–æ–º–µ–Ω—Ç—É

–£ –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å:

- session
- protectedProcedure
- RBAC
- ownership
- middleware security

–¢–µ–ø–µ—Ä—å –¥–æ–±–∞–≤–ª—è–µ–º –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π —Å–ª–æ–π.

---

# Fullstack data-flow

```mermaid
flowchart LR
  Browser --> UI
  UI --> tRPC
  tRPC --> Router
  Router --> Access
  Access --> DB
  DB --> Router
  Router --> UI
```

---

# –ò—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã

Server:

- –ø—Ä–æ–≤–µ—Ä—è–µ—Ç session
- –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å
- –ø—Ä–æ–≤–µ—Ä—è–µ—Ç ownership

UI:

- —É–ª—É—á—à–∞–µ—Ç UX
- –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

---

# currentUser –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

<span class="lab-badge">üß™ bauth31</span>

–ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

```ts
const { data: user } =
  trpc.auth.currentUser.useQuery()
```

---

# –ß—Ç–æ –≤–∞–∂–Ω–æ

- user –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å —Å–µ—Ä–≤–µ—Ä–∞
- UI –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–æ–ª—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ
- —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Å backend

---

# SSR (Server-Side Rendering) –∏ currentUser

- –ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ  
- Cookie –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –∑–∞–ø—Ä–æ—Å–µ  
- currentUser –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –¥–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ HTML  
- –ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —É–∂–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ  

Hydration —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ.

---

# UI Guard-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç

<span class="lab-badge">üß™ bauth32</span>

```tsx
if (!user) {
  return <LoginPrompt />
}

return <ProtectedContent />
```

---

# UI Guard ‚Äî —ç—Ç–æ

- –∑–∞—â–∏—Ç–∞ UX
- –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- –Ω–µ –∑–∞–º–µ–Ω–∞ server-–ø—Ä–æ–≤–µ—Ä–∫–∏

---

# Layout-level redirect

<span class="lab-badge">üß™ bauth33</span>

```ts
if (!user) {
  redirect("/login")
}
```

---

# Redirect –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è

- –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –¥–æ —Ä–µ–Ω–¥–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- —á–µ—Ä–µ–∑ App Router

---

# Role-based UI rendering

<span class="lab-badge">üß™ bauth34</span>

```tsx
{user?.role === "ADMIN" && (
  <AdminPanel />
)}
```

---

# –í–∞–∂–Ω—ã–π –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç

–°–∫—Ä—ã—Ç–∞—è –∫–Ω–æ–ø–∫–∞ ‚â† –∑–∞—â–∏—â—ë–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è.

Server –≤—Å—ë —Ä–∞–≤–Ω–æ –æ–±—è–∑–∞–Ω –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–æ–ª—å.

---

# –ó–∞—â–∏—â—ë–Ω–Ω–∞—è client mutation

<span class="lab-badge">üß™ bauth35</span>

```ts
const mutation = trpc.post.delete.useMutation({
  onSuccess: () => utils.post.list.invalidate(),
})
```

---

# –°–∫–≤–æ–∑–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π

1. UI –≤—ã–∑—ã–≤–∞–µ—Ç mutation  
2. Router –≤—ã–ø–æ–ª–Ω—è–µ—Ç protectedProcedure  
3. Access-layer –ø—Ä–æ–≤–µ—Ä—è–µ—Ç ownership  
4. DB –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è  
5. invalidate –æ–±–Ω–æ–≤–ª—è–µ—Ç UI  

---

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–æ—Å—Ç—É–ø–∞

<span class="lab-badge">üß™ bauth36</span>

```ts
if (error?.data?.code === "UNAUTHORIZED") {
  redirect("/login")
}

if (error?.data?.code === "FORBIDDEN") {
  showMessage("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤")
}
```

---

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

UNAUTHORIZED:

- –Ω–µ—Ç session

FORBIDDEN:

- –ø—Ä–∞–≤ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ

UI –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç,  
–Ω–æ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä.

---

# –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ access-layer

<span class="lab-badge">üß™ bauth37</span>

```ts
if (post.ownerId !== userId) {
  throw new ForbiddenError()
}
```

---

# –ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ

–î–∞–∂–µ –µ—Å–ª–∏:

- UI —Å–∫—Ä—ã–ª –∫–Ω–æ–ø–∫—É
- Router –ø—Ä–æ–≤–µ—Ä–∏–ª —Ä–æ–ª—å

Access-layer –æ—Å—Ç–∞—ë—Ç—Å—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –∑–∞—â–∏—Ç–æ–π.

---

# –ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ —Ç–æ–ª—å–∫–æ –≤ UI

<span class="lab-badge">üß™ bauth38</span>

–ü—Ä–æ–±–ª–µ–º–∞:

- –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å API –Ω–∞–ø—Ä—è–º—É—é
- UI-–∑–∞—â–∏—Ç–∞ –ª–µ–≥–∫–æ –æ–±—Ö–æ–¥–∏—Ç—Å—è

---

# –ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω: –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ router

<span class="lab-badge">üß™ bauth39</span>

Router:

- –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –¥–æ–º–µ–Ω–∞
- –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–µ—Ä—è—Ç—å ownership
- –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–º

---

# –ü–æ–ª–Ω—ã–π –∑–∞—â–∏—â—ë–Ω–Ω—ã–π data-flow

<span class="lab-badge">üß™ bauth40</span>
<div class="mermaid-fit">
```mermaid
sequenceDiagram
  participant U as User
  participant UI
  participant R as Router
  participant A as Access
  participant DB

  U->>UI: –¥–µ–π—Å—Ç–≤–∏–µ
  UI->>R: mutation
  R->>R: protectedProcedure
  R->>A: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤
  A->>DB: –∏–∑–º–µ–Ω–µ–Ω–∏–µ
  DB-->>A: —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  A-->>R: –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
  R-->>UI: response
```
</div>
---

# –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. Session –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ  
2. RBAC –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–µ–Ω  
3. Ownership –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ access-layer  
4. UI –Ω–µ –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã  
5. –û—à–∏–±–∫–∏ –∏–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å–µ–º–∞–Ω—Ç–∏–∫—É  

---

# Production-ready –º–æ–¥–µ–ª—å

- Cookie –∑–∞—â–∏—â–µ–Ω—ã  
- Session –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è  
- RBAC —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω  
- Ownership –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω  
- Middleware –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω  
- UI —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω —Å —Å–µ—Ä–≤–µ—Ä–æ–º  

---

# –ò—Ç–æ–≥ –∫—É—Ä—Å–∞

–ú—ã –ø–æ—Å—Ç—Ä–æ–∏–ª–∏:

- –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É session  
- –º–æ–¥–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏  
- production security  
- —Ü–µ–ª–æ—Å—Ç–Ω—ã–π fullstack data-flow  

---

# –ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–Ω—è—Ç–Ω–æ

–í—ã –¥–æ–ª–∂–Ω—ã –ø–æ–Ω–∏–º–∞—Ç—å:

- –≥–¥–µ –∂–∏–≤—ë—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å  
- –∫–∞–∫ —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è —É—Ä–æ–≤–Ω–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏  
- –ø–æ—á–µ–º—É server ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã  
- –∫–∞–∫ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∑–∞—â–∏—â—ë–Ω–Ω–æ–µ fullstack-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ  

---

# Summary

Client integration:

- —É–ª—É—á—à–∞–µ—Ç UX  
- –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å  

–ü–æ–ª–Ω–∞—è –∑–∞—â–∏—Ç–∞:

- —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ  
- —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑—É–µ—Ç—Å—è  
- –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ  
- –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è  

–ö—É—Ä—Å –∑–∞–≤–µ—Ä—à—ë–Ω.
```
